# 训练配置文件
# Curi1 World Model - DreamerV4

# 继承默认配置
defaults:
  - default

# 环境配置
env:
  name: "Curi1-v0"
  max_episode_steps: 1000

# 模型配置
model:
  vae:
    latent_dim: 32
    input_channels: 3

  rssm:
    stoch_dim: 32
    deter_dim: 256
    hidden_dim: 256

  actor:
    hidden_dim: 256
    num_layers: 3

  critic:
    hidden_dim: 256
    num_layers: 3
    num_critics: 2

  kl_weight: 1.0
  free_nats: 3.0

# 训练配置
training:
  # 总体训练参数
  num_episodes: 10000      # 总训练 episode 数
  prefill_episodes: 5      # 预填充回放缓冲区的 episode 数

  # 批次和序列参数
  batch_size: 16           # 批量大小
  seq_len: 50              # 序列长度

  # 想象轨迹参数
  imagine_horizon: 15      # 想象轨迹长度

  # 训练频率
  train_steps_per_episode: 100  # 每个 episode 的训练步数

  # 强化学习参数
  gamma: 0.99              # 折扣因子
  lambda: 0.95             # GAE lambda

  # 优化器参数
  learning_rate: 3e-4      # 学习率
  adam_eps: 1e-5           # Adam epsilon
  grad_clip_norm: 100.0    # 梯度裁剪阈值

  # 学习率调度
  lr_schedule: "constant"  # constant, linear, cosine
  lr_warmup_steps: 0       # 预热步数

  # 回放缓冲区
  buffer_capacity: 100000  # 回放缓冲区容量

  # VAE 特定参数（如果单独训练 VAE）
  vae:
    num_epochs: 100
    batch_size: 32
    learning_rate: 1e-4
    kl_weight: 1.0
    save_interval: 10

  # 保存和日志
  log_interval: 10         # 每 N 个 episode 记录一次
  save_interval: 100       # 每 N 个 episode 保存一次
  eval_interval: 50        # 每 N 个 episode 评估一次
  eval_episodes: 5         # 评估时运行的 episode 数

# 探索配置
exploration:
  initial_random_episodes: 5   # 初始随机探索的 episode 数
  action_noise: 0.3            # 动作噪声标准差
  noise_decay: 0.9999          # 噪声衰减率

# 数据增强（可选）
augmentation:
  enabled: false
  random_crop: true
  random_shift: true
  color_jitter: false

# 设备配置
device: "cuda"
num_workers: 4           # 数据加载器的工作进程数
pin_memory: true         # 是否固定内存

# 随机种子
seed: 42

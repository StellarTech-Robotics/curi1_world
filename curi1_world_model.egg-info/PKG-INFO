Metadata-Version: 2.4
Name: curi1-world-model
Version: 0.1.0
Summary: åŸºäº VAE ä¸–ç•Œæ¨¡å‹å’Œ DreamerV4 çš„æœºå™¨äººå¼ºåŒ–å­¦ä¹ 
Home-page: https://github.com/yourusername/curi1_world
Author: Curi1 Team
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Science/Research
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: torch>=2.0.0
Requires-Dist: torchvision>=0.15.0
Requires-Dist: numpy>=1.24.0
Requires-Dist: scipy>=1.10.0
Requires-Dist: gym>=0.26.0
Requires-Dist: gymnasium>=0.28.0
Requires-Dist: Pillow>=9.5.0
Requires-Dist: opencv-python>=4.7.0
Requires-Dist: imageio>=2.28.0
Requires-Dist: h5py>=3.8.0
Requires-Dist: pandas>=2.0.0
Requires-Dist: pyyaml>=6.0
Requires-Dist: omegaconf>=2.3.0
Requires-Dist: tensorboard>=2.12.0
Requires-Dist: matplotlib>=3.7.0
Requires-Dist: seaborn>=0.12.0
Requires-Dist: wandb>=0.15.0
Requires-Dist: tqdm>=4.65.0
Requires-Dist: pytest>=7.3.0
Requires-Dist: black>=23.3.0
Requires-Dist: flake8>=6.0.0
Provides-Extra: dev
Requires-Dist: pytest>=7.3.0; extra == "dev"
Requires-Dist: black>=23.3.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Requires-Dist: jupyter>=1.0.0; extra == "dev"
Provides-Extra: wandb
Requires-Dist: wandb>=0.15.0; extra == "wandb"
Dynamic: author
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: provides-extra
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# Curi1 World Model - DreamerV4

åŸºäº VAE ä¸–ç•Œæ¨¡å‹å’Œ DreamerV4 ç®—æ³•çš„ Curi1 æœºå™¨äººå¼ºåŒ–å­¦ä¹ é¡¹ç›®ã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªå®Œæ•´çš„ä¸–ç•Œæ¨¡å‹å¼ºåŒ–å­¦ä¹ ç³»ç»Ÿï¼Œç”¨äº Curi1 æœºå™¨äººæ§åˆ¶ä»»åŠ¡ã€‚ç³»ç»ŸåŒ…å«ä»¥ä¸‹æ ¸å¿ƒç»„ä»¶ï¼š

- **VAE (Variational Autoencoder)**: å­¦ä¹ è§‚å¯Ÿç©ºé—´çš„ç´§å‡‘æ½œåœ¨è¡¨ç¤º
- **RSSM (Recurrent State Space Model)**: å­¦ä¹ ç¯å¢ƒåŠ¨æ€å’Œé¢„æµ‹æœªæ¥çŠ¶æ€
- **Actor-Critic**: ç­–ç•¥ç½‘ç»œå’Œä»·å€¼ç½‘ç»œï¼Œç”¨äºå†³ç­–å’Œä»·å€¼ä¼°è®¡
- **DreamerV4**: æ•´åˆä»¥ä¸Šç»„ä»¶çš„å®Œæ•´ä¸–ç•Œæ¨¡å‹å¼ºåŒ–å­¦ä¹ ç®—æ³•

## é¡¹ç›®ç»“æ„

```
curi1_world/
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ requirements.txt            # Python ä¾èµ–
â”œâ”€â”€ setup.py                    # å®‰è£…è„šæœ¬
â”œâ”€â”€ configs/                    # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ default.yaml           # é»˜è®¤é…ç½®
â”‚   â”œâ”€â”€ train.yaml             # è®­ç»ƒé…ç½®
â”‚   â””â”€â”€ eval.yaml              # è¯„ä¼°é…ç½®
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â”œâ”€â”€ models/                # æ¨¡å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ vae.py            # VAE æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ rnn.py            # RSSM æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ controller.py     # Actor-Critic
â”‚   â”‚   â””â”€â”€ dreamer.py        # DreamerV4 ä¸»æ¨¡å‹
â”‚   â”œâ”€â”€ agents/                # æ™ºèƒ½ä½“
â”‚   â”‚   â””â”€â”€ dreamer_agent.py  # DreamerV4 æ™ºèƒ½ä½“
â”‚   â”œâ”€â”€ envs/                  # ç¯å¢ƒæ¥å£
â”‚   â”‚   â””â”€â”€ robot_env.py      # æœºå™¨äººç¯å¢ƒ
â”‚   â””â”€â”€ utils/                 # å·¥å…·æ¨¡å—
â”‚       â”œâ”€â”€ data_loader.py    # æ•°æ®åŠ è½½
â”‚       â”œâ”€â”€ replay_buffer.py  # å›æ”¾ç¼“å†²åŒº
â”‚       â””â”€â”€ logger.py         # æ—¥å¿—è®°å½•
â”œâ”€â”€ scripts/                    # è®­ç»ƒå’Œè¯„ä¼°è„šæœ¬
â”‚   â”œâ”€â”€ train_vae.py          # VAE é¢„è®­ç»ƒ
â”‚   â”œâ”€â”€ train_dreamer.py      # DreamerV4 è®­ç»ƒ
â”‚   â””â”€â”€ evaluate.py           # æ¨¡å‹è¯„ä¼°
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ raw/                  # åŸå§‹æ•°æ®
â”‚   â””â”€â”€ processed/            # å¤„ç†åçš„æ•°æ®
â”œâ”€â”€ experiments/                # å®éªŒç»“æœ
â”‚   â”œâ”€â”€ logs/                 # è®­ç»ƒæ—¥å¿—
â”‚   â”œâ”€â”€ checkpoints/          # æ¨¡å‹æ£€æŸ¥ç‚¹
â”‚   â””â”€â”€ results/              # è¯„ä¼°ç»“æœ
â””â”€â”€ notebooks/                  # Jupyter notebooks
    â””â”€â”€ visualization.ipynb   # å¯è§†åŒ–åˆ†æ
```

## ç¯å¢ƒè®¾ç½®

### 1. åˆ›å»º Conda ç¯å¢ƒ

```bash
conda create -n curi1_world python=3.9
conda activate curi1_world
```

### 2. å®‰è£…ä¾èµ–

```bash
cd curi1_world
pip install -r requirements.txt
```

### 3. å®‰è£…é¡¹ç›®

```bash
pip install -e .
```

## ä½¿ç”¨æŒ‡å—

### æ•°æ®æ”¶é›†

é¦–å…ˆéœ€è¦æ”¶é›†æœºå™¨äººäº¤äº’æ•°æ®ç”¨äºè®­ç»ƒã€‚æ•°æ®åº”åŒ…å«è§‚å¯Ÿåºåˆ—ã€åŠ¨ä½œåºåˆ—å’Œå¥–åŠ±åºåˆ—ã€‚

```python
# ç¤ºä¾‹ï¼šæ”¶é›†æ•°æ®
from src.envs.robot_env import RobotEnv
from src.utils.data_loader import save_episode

env = RobotEnv(env_name="Curi1-v0")
# æ”¶é›†å¤šä¸ª episode å¹¶ä¿å­˜
```

### VAE é¢„è®­ç»ƒï¼ˆå¯é€‰ï¼‰

å¯ä»¥å…ˆå•ç‹¬é¢„è®­ç»ƒ VAE æ¥å­¦ä¹ è§‚å¯Ÿçš„æ½œåœ¨è¡¨ç¤ºï¼š

```bash
python scripts/train_vae.py \
    --config configs/train.yaml \
    --data_dir data/raw \
    --exp_name vae_pretrain
```

### DreamerV4 è®­ç»ƒ

ç«¯åˆ°ç«¯è®­ç»ƒå®Œæ•´çš„ä¸–ç•Œæ¨¡å‹å’Œç­–ç•¥ï¼š

```bash
python scripts/train_dreamer.py \
    --config configs/train.yaml \
    --env_name Curi1-v0 \
    --exp_name dreamer_v4_run1 \
    --device cuda
```

è®­ç»ƒå‚æ•°å¯ä»¥åœ¨ `configs/train.yaml` ä¸­é…ç½®ï¼š

- `num_episodes`: è®­ç»ƒçš„æ€» episode æ•°
- `batch_size`: æ‰¹é‡å¤§å°
- `seq_len`: åºåˆ—é•¿åº¦
- `imagine_horizon`: æƒ³è±¡è½¨è¿¹é•¿åº¦
- `learning_rate`: å­¦ä¹ ç‡
- ç­‰ç­‰...

### æ¨¡å‹è¯„ä¼°

è¯„ä¼°è®­ç»ƒå¥½çš„æ¨¡å‹ï¼š

```bash
python scripts/evaluate.py \
    --checkpoint experiments/checkpoints/dreamer_v4_run1/best_model.pt \
    --env_name Curi1-v0 \
    --num_episodes 10 \
    --deterministic \
    --device cuda
```

è¯„ä¼°ç»“æœå°†ä¿å­˜åœ¨ `experiments/results/` ç›®å½•ä¸‹ã€‚

## æ ¸å¿ƒç®—æ³•

### DreamerV4 å·¥ä½œæµç¨‹

1. **æ•°æ®æ”¶é›†**: ä¸ç¯å¢ƒäº¤äº’æ”¶é›†ç»éªŒæ•°æ®
2. **ä¸–ç•Œæ¨¡å‹å­¦ä¹ **:
   - VAE å­¦ä¹ è§‚å¯Ÿçš„æ½œåœ¨è¡¨ç¤º
   - RSSM å­¦ä¹ çŠ¶æ€è½¬ç§»åŠ¨æ€
   - é¢„æµ‹å¥–åŠ±å’Œç»ˆæ­¢ä¿¡å·
3. **ç­–ç•¥å­¦ä¹ **:
   - åœ¨ä¸–ç•Œæ¨¡å‹ä¸­æƒ³è±¡æœªæ¥è½¨è¿¹
   - Actor ä¼˜åŒ–ç­–ç•¥ä»¥æœ€å¤§åŒ–æƒ³è±¡ä¸­çš„ç´¯ç§¯å¥–åŠ±
   - Critic å­¦ä¹ ä»·å€¼å‡½æ•°
4. **é‡å¤**: ä½¿ç”¨æ›´æ–°åçš„ç­–ç•¥æ”¶é›†æ–°æ•°æ®

### å…³é”®ç‰¹æ€§

- **æ¨¡å‹é©±åŠ¨**: å­¦ä¹ ç¯å¢ƒæ¨¡å‹ï¼Œæé«˜æ ·æœ¬æ•ˆç‡
- **æƒ³è±¡è§„åˆ’**: åœ¨å­¦åˆ°çš„ä¸–ç•Œæ¨¡å‹ä¸­è¿›è¡Œå‰ç»è§„åˆ’
- **ç«¯åˆ°ç«¯å­¦ä¹ **: ä»åŸå§‹è§‚å¯Ÿåˆ°åŠ¨ä½œçš„ç«¯åˆ°ç«¯è®­ç»ƒ
- **çµæ´»æ¶æ„**: æ”¯æŒå›¾åƒã€çŠ¶æ€æˆ–æ··åˆè§‚å¯Ÿ

## é…ç½®è¯´æ˜

### æ¨¡å‹é…ç½®

åœ¨ `configs/train.yaml` ä¸­å¯ä»¥é…ç½®ï¼š

- **VAE**: `latent_dim`, `encoder_hidden_dims`, `decoder_hidden_dims`
- **RSSM**: `stoch_dim`, `deter_dim`, `hidden_dim`
- **Actor**: `hidden_dim`, `num_layers`
- **Critic**: `hidden_dim`, `num_critics`

### è®­ç»ƒé…ç½®

- `batch_size`: æ‰¹é‡å¤§å°ï¼ˆé»˜è®¤ 16ï¼‰
- `seq_len`: åºåˆ—é•¿åº¦ï¼ˆé»˜è®¤ 50ï¼‰
- `imagine_horizon`: æƒ³è±¡æ­¥æ•°ï¼ˆé»˜è®¤ 15ï¼‰
- `gamma`: æŠ˜æ‰£å› å­ï¼ˆé»˜è®¤ 0.99ï¼‰
- `lambda`: GAE lambdaï¼ˆé»˜è®¤ 0.95ï¼‰
- `learning_rate`: å­¦ä¹ ç‡ï¼ˆé»˜è®¤ 3e-4ï¼‰

## æœºå™¨äººæ¥å£

`src/envs/robot_env.py` ä¸­çš„ `Curi1Env` ç±»éœ€è¦æ ¹æ®å®é™…æœºå™¨äºº API å®ç°ã€‚ä¸»è¦éœ€è¦å®ç°ä»¥ä¸‹æ–¹æ³•ï¼š

- `_init_robot()`: åˆå§‹åŒ–æœºå™¨äººè¿æ¥
- `_get_camera_image()`: è·å–ç›¸æœºå›¾åƒ
- `_get_robot_state()`: è·å–æœºå™¨äººçŠ¶æ€
- `_execute_action()`: æ‰§è¡ŒåŠ¨ä½œå‘½ä»¤
- `_compute_reward()`: è®¡ç®—ä»»åŠ¡å¥–åŠ±

ç¤ºä¾‹ä½¿ç”¨ ROS æ¥å£çš„å®ç°å·²åœ¨ä»£ç æ³¨é‡Šä¸­æä¾›ã€‚

## å®éªŒè·Ÿè¸ª

### TensorBoard

è®­ç»ƒè¿‡ç¨‹ä¸­çš„æŒ‡æ ‡ä¼šè‡ªåŠ¨è®°å½•åˆ° TensorBoardï¼š

```bash
tensorboard --logdir experiments/logs
```

### Weights & Biasesï¼ˆå¯é€‰ï¼‰

å¦‚æœå®‰è£…äº† wandbï¼Œå¯ä»¥å¯ç”¨åœ¨çº¿å®éªŒè·Ÿè¸ªï¼š

```bash
# åœ¨ configs/train.yaml ä¸­è®¾ç½®
logging:
  wandb: true
  wandb_project: "curi1_world_model"
```

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•è°ƒæ•´æ¨¡å‹å¤§å°ï¼Ÿ

A: åœ¨ `configs/train.yaml` ä¸­ä¿®æ”¹æ¨¡å‹é…ç½®å‚æ•°ï¼Œå¦‚ `latent_dim`, `stoch_dim`, `deter_dim` ç­‰ã€‚

### Q: è®­ç»ƒéœ€è¦å¤šé•¿æ—¶é—´ï¼Ÿ

A: å–å†³äºä»»åŠ¡å¤æ‚åº¦å’Œç¡¬ä»¶é…ç½®ã€‚é€šå¸¸éœ€è¦æ•°åƒåˆ°æ•°ä¸‡ä¸ª episodesã€‚å»ºè®®ä½¿ç”¨ GPU åŠ é€Ÿã€‚

### Q: å¦‚ä½•ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼Ÿ

A: ä½¿ç”¨ `--resume` å‚æ•°åŠ è½½æ£€æŸ¥ç‚¹ï¼š

```bash
python scripts/train_dreamer.py --resume experiments/checkpoints/.../checkpoint.pt
```

### Q: å¦‚ä½•è°ƒè¯•ç¯å¢ƒæ¥å£ï¼Ÿ

A: è¿è¡Œç¯å¢ƒæµ‹è¯•ä»£ç ï¼š

```bash
python -m src.envs.robot_env
```

## å‚è€ƒæ–‡çŒ®

- [World Models](https://arxiv.org/abs/1803.10122) - Ha & Schmidhuber, 2018
- [Dream to Control](https://arxiv.org/abs/1912.01603) - Hafner et al., 2019
- [Mastering Atari with Discrete World Models](https://arxiv.org/abs/2010.02193) - Hafner et al., 2020
- [DreamerV3](https://arxiv.org/abs/2301.04104) - Hafner et al., 2023

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»é¡¹ç›®ç»´æŠ¤è€…ã€‚

---

**ç¥è®­ç»ƒé¡ºåˆ©ï¼** ğŸ¤–ğŸš€
